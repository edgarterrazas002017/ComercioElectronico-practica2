var htmlEntities=function(a){return jQuery("<div>").html(a).text()};var okField=function(a){a.removeClass("noreg").addClass("okreg").attr("title","").tipsy("hide")};var noField=function(a,b){a.removeClass("okreg").addClass("noreg").attr("title",htmlEntities(b)).tipsy("show")};var checkData=function(b){var d="";switch(b.attr("id")){case"temail":if(!validateEmail(b.val())){noField(b,"Email inv&aacute;lido")}else{if(checkEmail(b.val())){noField(b,"Email ya est&aacute; registrado")}else{okField(b)}}break;case"tname":if(jQuery.trim(b.val())===""){noField(b,"Debe ingresar el Nombre de Usuario")}else{if(checkUser(b.val())){noField(b,"Usuario ya existente")}else{okField(b)}}break;case"tpass":var c=jQuery.trim(b.val());if(c===""){noField(b,"Ingrese una clave de al menos 6 letras")}else{if(c.length<6){noField(b,"Clave debe ser mayor a 6 letras")}else{okField(b)}}break;case"tci":var a=jQuery.trim(b.val());if(a.length>1){if(jQuery("#userdpto").val()=="0"){noField(jQuery("#userdpto"),"Seleccione su Departamento")}else{okField(jQuery("#userdpto"))}}break}};var typingTimeout;var startTypingTime=function(a){if(typingTimeout!=undefined){clearTimeout(typingTimeout)}typingTimeout=setTimeout(function(){checkData(a)},1000)};var loadCountries=function(){jQuery.getJSON("dynamic/registration/js/countries.json",function(a){jQuery.each(a,function(b,c){jQuery("<option>").attr("value",c.code).html(c.name).appendTo("#tpais")});jQuery("#tpais [value=BOL]").attr("selected","selected")})};var validateEmail=function(b){var a=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;return a.test(b)};var checkUser=function(a){var b=false;jQuery.ajaxSetup({async:false});jQuery.getJSON("dynamic/registration/check.php?opt=cu&u="+escape(a),function(c){b=c.check});return b};var checkEmail=function(a){var b=false;jQuery.ajaxSetup({async:false});jQuery.getJSON("dynamic/registration/check.php?opt=ce&e="+escape(a),function(c){b=c.check});return b};var showMessage=function(a,b){if(a==="no"){alert(b)}};var registerUser=function(a,e,b,f,c,d){jQuery.post("dynamic/registration/check.php",{opt:"ru",u:a,c:e,e:b,p:f,ci:c,nt:d},function(g){showMessage(g.status,g.message);if(g.status==="ok"){window.location.href="index.php?page=regok&email="+b}},"json")};var validate=function(a,b,d,e,c){return !checkUser(a)&&(validateEmail(b)&&!checkEmail(b))&&(d.length>=6)&&(e!=="0")&&(c!="0")};var showModal=function(){jQuery("#tregn").dialog({width:300,modal:true,autoOpen:false,resizable:false});jQuery(".ui-dialog-titlebar").hide();jQuery(".ui-dialog .ui-dialog-content").css("padding","0px");jQuery(".ui-dialog").css("padding","0px");jQuery("#tregn").dialog("open")};jQuery(function(){jQuery(".mreg input").tipsy({trigger:"manual",gravity:"w"});loadCountries();jQuery("#treg").click(function(){var a=jQuery("#tname").val();var f=jQuery("#tpass").val();var b=jQuery("#temail").val();var g=jQuery("#tpais").find("option:selected").text();var c=jQuery("#tci").val();var d=jQuery("#tnit").val();var e=jQuery("#userdpto").val();if(c.length>1){if(!checkUser(a)&&(validateEmail(b)&&!checkEmail(b))&&(f.length>=6)&&(g!=="0")&&(e!=="0")&&(c.length>1)){registerUser(a,f,b,g,c+"-"+e,d)}else{showMessage("no",htmlEntities("Informacion incorrecta, verifique e intente nuevamente"))}}else{if(e==0){e="";registerUser(a,f,b,g,c+e,d)}}});jQuery(".mreg input").blur(function(){checkData(jQuery(this))}).live("keypress",function(a){startTypingTime(jQuery(a.target))});jQuery(".mreg input").tipsy("hide");jQuery("#tregn").bind("keydown",function(a){return a.which==27?false:true});jQuery(".mclose").click(function(){jQuery("#tregn").dialog("close").find(".inptext input").val("").removeClass("noreg").addClass("reg");jQuery(".tipsy").remove()});jQuery(".mreg input").keyup(function(){jQuery(this).parent().find("span").html("")}).focus(function(){}).blur(function(){if(jQuery(this).val()===""){span=jQuery(this).parent().find("span");jQuery(this).parent().find("span").html(span.attr("title"))}});jQuery(".holder").click(function(){jQuery(this).parent().find("input").focus()})});